# A.1概述

LC-3的指令集结构（ISA）定义如下：

* 内存地址空间16位，对应于2^16个位置，每个位置包含一个字（16位）。地址编号从0（0x0000)到65535（0xFFFF)。地址用于识别内存位置和映射I/o设备寄存器。存储器的某些区域被保留用于特殊用途，如A.1图中所述：

  ![image-20230620232615928](E:\CodeLibraries\lc3-vm\lz3\img\image-20230620232615928.png)

* 位的编号：所有数量的位都有编号，从右到左，从0位开始。一个内存位置的内容最左位置是第15位。

* 指令：指令宽度为16位，位[15:12]指定操作码（要执行的操作），位[11:0]提供进一步的信息，即执行该指令所需的数据。每条LC-3指令的具体操作将在A.3节中描述。

* 非法操作码异常：比特[15:12]=1101，非法操作码异常。

* 程序计数器：一个16位的寄存器，包含下一条要处理指令的地址。

* 通用寄存器：8个16位寄存器，编号从000~111

* 条件代码： 三个1位寄存器，N(负)，Z（零），P（正）。加载指令（LD,LDI,LDR和LEA)和操作指令（ADD,AND和NOT）分别将一个结果加载到8个通用寄存器中的一个。分为以下三种情况：

  * N=1, Z = 0, P = 0 为负数
  * N=0, Z = 1, P = 0 为零
  * N=0, Z = 0, P = 1为正数

* 内存映射的I/O输入和输出，由加载/存储(LDI/STI,LDR/STR)指令处理，使用内存地址指定每个I/o设备寄存器。地址0xFE00~0xFFFF已经分配出来代表I/O设备地址。见图A.1。另外，表A.3列出了LC-3确定的每个相关设备寄存器。以及它们在内存地址空间的相应分配地址。

* 中断处理 i/o设备具有中断设备处理的能力。A.4节描述了这种机制。

* 优先级水平 ：LC-3支持支持八个优先级水平，优先级7（pl 7）是最高的；PL0是最低的。当前执行进程的优先级在为PSR[10:8]中指定。

* 处理器状态寄存器(PSR):一个16位寄存器。包含当前执行进程的状态信息。到目前为止，PSR的7位已经被定义。PSR[15]指定特权模式是正在执行的进程。PSR[10:8]指定当前执行的进程优先级。PSR[2:0]包含条件代码。PSR[2]是N, PSR[1]是Z，PSR[0]是P

* 特权模式 LC-3规定了两个级别的权限，监督者模式（特权）和用户模式（非特权）。中断服务程序在监督者模式下执行，特权模式由PSR[15]指定的。PSR[15]=0表示监督者模式；PSR[15]=1表示用户模式。

* 特权模式异常：RTI指令在监管模式下执行。如果处理器在用户模式下执行RTI指令，就会发生一个特权模式异常。A.4节解释了会发生什么。

* 监督员堆栈：监督员空间的一个内存区域，可以通过监督员堆栈指针(ssp)访问。当PSR[15]=0时，堆栈指针R6就是SSP

* 用户堆栈 用户空间内的一个内存区域，可以通过用户堆栈指针(USP)访问。当PSR[15]=1时，堆栈指针R6就是USP